<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Miku Proxy</title>

  <!-- Google font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: "Inter", sans-serif;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      overflow: hidden;
    }

    .container {
      text-align: center;
      width: 100%;
      max-width: 500px;
    }

    .miku-img {
      width: 180px;
      margin-bottom: 25px;
      filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.2));
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: center;
    }

    .input-wrapper {
      position: relative;
      width: 100%;
    }

    .input-wrapper i {
      position: absolute;
      left: 14px;
      top: 50%;
      transform: translateY(-50%);
      color: #666;
      font-size: 15px;
    }

    .styled-input, 
    .styled-select {
      width: 100%;
      height: 48px;
      border: none;
      border-radius: 10px;
      font-size: 15px;
      outline: none;
      background: #111;
      color: #fff;
      padding: 0 16px 0 40px;
      transition: all 0.25s ease;
    }

    .styled-input:focus,
    .styled-select:hover {
      background: #1a1a1a;
      box-shadow: 0 0 12px rgba(255, 255, 255, 0.2);
    }

    .styled-select {
      appearance: none;
      cursor: pointer;
      font-weight: 600;
    }

    .select-wrapper {
      position: relative;
      width: 100%;
    }

    .select-wrapper i {
      position: absolute;
      left: 14px;
      top: 50%;
      transform: translateY(-50%);
      color: #666;
      font-size: 15px;
      pointer-events: none;
    }

    /* fullscreen iframe */
    #overlay {
      position: fixed;
      inset: 0;
      display: none;
      background: #000;
      z-index: 9999;
    }
    #overlay.active { display: block; }
    #iframe {
      width: 100vw;
      height: 100vh;
      border: none;
    }

    /* loading overlay */
    #loading {
      position: fixed;
      inset: 0;
      background: #000;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      text-align: center;
    }
    #loading.active { display: flex; }

    #loading img {
      width: 200px;
      animation: bounce 1.3s infinite;
      filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.4));
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    #loading p {
      margin-top: 16px;
      font-size: 16px;
      font-weight: 600;
      color: #aaa;
      letter-spacing: 0.5px;
    }

    /* Close button */
    #closeBtn {
      position: fixed;
      top: 15px;
      right: 20px;
      z-index: 10001;
      background: #111;
      border: none;
      color: #fff;
      font-size: 14px;
      padding: 8px 14px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.25s ease;
    }

    #closeBtn:hover {
      background: #1a1a1a;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
    }
  </style>
</head>
<body>
  <div class="container">
    <img class="miku-img" src="https://www.pngarts.com/files/9/Anime-Miku-Hatsune-Transparent-Images.png" alt="Miku" />
    <form id="idk">
      <div class="input-wrapper">
        <i class="fa-solid fa-magnifying-glass"></i>
        <input id="url" type="text" class="styled-input" placeholder="Enter a site (example.com)" required />
      </div>
      <div class="select-wrapper">
        <i class="fa-solid fa-random"></i>
        <select id="proxysel" class="styled-select">
          <option value="uv">Ultraviolet</option>
          <option value="scramjet">Scramjet</option>
        </select>
      </div>
    </form>
  </div>

  <!-- fullscreen overlay -->
  <div id="overlay">
    <button id="closeBtn"><i class="fa-solid fa-xmark"></i> Close</button>
    <iframe id="iframe" sandbox="allow-forms allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox" allowfullscreen></iframe>
  </div>

  <!-- loading overlay -->
  <div id="loading">
    <img src="https://www.pngarts.com/files/8/Hatsune-Miku-Download-Transparent-PNG-Image.png" alt="Loading Miku" />
    <p>Loading pageâ€¦</p>
  </div>

  <!-- proxy scripts -->
  <script src="/baremux/index.js" defer></script>
  <script src="/uv/uv.bundle.js" defer></script>
  <script src="/uv/uv.config.js" defer></script>
  <script src="/scram/scramjet.all.js" defer></script>
  <script src="/stuff.js" defer></script>

  <script>
    const form = document.getElementById("idk");
    const input = document.getElementById("url");
    const sel = document.getElementById("proxysel");
    const overlay = document.getElementById("overlay");
    const iframe = document.getElementById("iframe");
    const closeBtn = document.getElementById("closeBtn");
    const loading = document.getElementById("loading");

    function normalizeUrl(value){
      value = value.trim();
      if(!value) return "";
      if(!/^https?:\/\//i.test(value)){
        value = "https://" + value;
      }
      try { return new URL(value).href; } catch { return ""; }
    }

    function buildProxyUrl(url, proxy){
      const enc = encodeURIComponent(url);
      if(proxy === "uv") return `/uv/?u=${enc}`;
      if(proxy === "scramjet") return `/scram/?u=${enc}`;
      return url;
    }

    form.addEventListener("submit", e=>{
      e.preventDefault();
      const raw = input.value;
      const normalized = normalizeUrl(raw);
      if(!normalized) return;
      const proxy = sel.value;
      const proxied = buildProxyUrl(normalized, proxy);

      loading.classList.add("active");
      iframe.src = proxied;
      overlay.classList.add("active");

      iframe.addEventListener("load", ()=>{
        loading.classList.remove("active");
      }, { once:true });
    });

    closeBtn.addEventListener("click", ()=>{
      iframe.src = "about:blank";
      overlay.classList.remove("active");
      loading.classList.remove("active");
    });
  </script>
</body>
</html>
